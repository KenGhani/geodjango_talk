<!DOCTYPE html>
<html>
<head>
<title>We Love Ponies!</title>
<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />

<style type="text/css">
  html { height: 100% }
  body { height: 100%; margin: 0px; padding: 0px }
  #map_canvas { height: 100% }
</style>

<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
<script type="text/javascript" src="http://code.jquery.com/jquery-1.6.2.min.js"></script>
<script type="text/javascript">

function initialize() {
    var map = new google.maps.Map(document.getElementById("map_canvas"), {
        zoom: 5,
        center: new google.maps.LatLng(39.0861702319, -77.1389579773),
        mapTypeId: google.maps.MapTypeId.ROADMAP
    });

    $.get('{% url ponypeople:get_all_people %}', function(data) {
        for (p in data.people) {
            add_djangonaut(map, data.people[p]);
        }
    });
}

function add_djangonaut(map, person) {
    var marker = new google.maps.Marker({
        position: new google.maps.LatLng(person.lat, person.lng),
        map: map
    });

    var infowindow = new google.maps.InfoWindow({
        content: person.name
    });
    
    google.maps.event.addListener(marker, 'click', function() {
      infowindow.open(map,marker);
    });
}

</script>
</head>

<body onload="initialize()">
    <div id="map_canvas"></div>
</body>

</html>